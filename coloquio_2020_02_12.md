3-
```
1) Realizar la seleccion lo antes posible.
2) Remplazar productos cartesianos por juntas siempre que sea posible.
3) Realizar las proyecciones lo antes posible. Entre una seleccion y una proyeccion siempre ir por la seleccion primero.
4) En caso de haber varias juntas, realizar la mas restrictiva primero. Usar arboles deep left, deep right.
```

4- Resuelto y probado en: https://mongoplayground.net/p/1_85wwnNljj

```bson
db.collection.aggregate([
  {
    "$unwind": "$pasajeros"
  },
  {
    "$group": {
      "_id": {
        "nro dnis": "$pasajeros.nro dni",
        "apell nombre": "$pasajeros.apell nombre",
        
      },
      "km totales": {
        "$sum": "$distancia km"
      },
      "listado_viajes": {
        "$addToSet": {
          fecha: "$fecha salida",
          cod_vuelo: "$cod vuelo",
          recorrido: "$recorrido"
        }
      }
    }
  },
  {
    $match: {
      "km totales": {
        $lt: 1000
      }
    }
  }
])
```
